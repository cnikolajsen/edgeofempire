<%- model_class = Character -%>
<% content_for :title do %>
  <%= @character.name %> - <%= @character.race.name %> <%= @character.career.name %>
<% end %>
<div class="page-header">
  <h1><%=t '.title', :default => @character.name %> <small><%= @character.race.name %> <%= @character.career.name %></small></h1>
</div>
<%= render :partial => 'character_edit_menu' %>
<%= simple_format(@character.bio) %>

<div class="well">
<table class="table table-striped">
  <tbody>
    <tr>
      <td><strong><%= model_class.human_attribute_name(:brawn) %> <%= @character.brawn %></strong></td>
      <td><strong><%= model_class.human_attribute_name(:cunning) %> <%= @character.cunning %></strong></td>
      <td><strong><%= model_class.human_attribute_name(:presence) %> <%= @character.presence %></strong></td>
    </tr>
    <tr>
      <td><strong><%= model_class.human_attribute_name(:agility) %> <%= @character.agility %></strong></td>
      <td><strong><%= model_class.human_attribute_name(:intellect) %> <%= @character.intellect %></strong></td>
      <td><strong><%= model_class.human_attribute_name(:willpower) %> <%= @character.willpower %></strong></td>
    </tr>
    <tr>
      <td colspan="3"><strong>Skills:</strong>
        <% @character.character_skills.each do |character_skill| %>
          <%= character_skill.skill.name %> <%= character_skill.ranks %> [<%= render :partial => "dice_pool", :locals => {:score => @character.send(character_skill.skill.characteristic.downcase), :ranks => character_skill.ranks} %>]<% if @character.character_skills.last != character_skill %>,<% end %>
        <% end %>
      </td>
    </tr>
    <tr>
      <td colspan="3"><strong>Talents:</strong>
        <% @talents.each_with_index do |element, index| %>
          <% talent_name = Talent.find_by_id(element[0]).name %>
          <%
            count = ''
            delimiter = ''
            if element[1] > 1
              count = " (#{element[1]})"
            end

            if index != @talents.length - 1
              delimiter = ", "
            end
          %>
          <%= "#{talent_name}#{count}#{delimiter}" %>
        <% end %>
      </td>
    </tr>
    <tr>
      <td><strong>Soak:</strong> <%= @soak%></td>
      <td></td>
      <td><strong>Defense:</strong> <%= @defense %></td>
    </tr>
    <tr>
      <td colspan="3"><strong>Wound Threshold:</strong> <%= @wound_th %></td>
    </tr>
    <tr>
      <td colspan="3"><strong>Strain Threshold:</strong> <%= @strain_th %></td>
    </tr>
    <tr>
      <td colspan="3"><strong>Equipment:</strong> <%= @equipment.join(', ')%></td>
    </tr>

  </tbody>
</table>
</div>

<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              characters_path, :class => 'btn'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_character_path(@character), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              character_path(@character),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
</div>
