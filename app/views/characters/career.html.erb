<div class="row">
  <div class="small-12 columns">
    <h1><%=t '.title', :default => "#{@character.name} - Career" %></h1>
  </div>
</div>
<div class="row">
  <div class="small-12 columns">
    <%= render :partial => 'character_edit_menu' %>
  </div>
</div>
<div class="row">
  <div class="small-12 columns">
    <% if @character.purchased_skills.count == 0 %>
      <%= form_for @character, :html => { :class => 'form-horizontal' } do |f| %>
        <%= hidden_field_tag 'character_career', 'true' %>
        <%= hidden_field_tag 'original_career_id', @character.career_id %>
        <% if @character.errors.any? %>
          <div data-alert class="alert-box warning radius">
            <p><%= pluralize(@character.errors.count, "error") %> prohibited this character from being saved:</p>
            <ul>
              <% @character.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <% if @character.creation? %>
          <div class="row">
            <div class="small-12 columns">
              <% if @character.career %>
                <%= f.label :class_skills, "Select #{if @character.race.name == 'Droid' then 6 else 4 end} career skills to add a free rank to:" %>
                <% @character.career.skills.each do |class_skill| %>
                  <input value="<%= class_skill.id %>" id="free_skill_rank_<%= class_skill.id %>" name="free_career_skill_rank[]" type="checkbox" <%= if @career_free_rank.include? class_skill.id then  "checked=checked" end %>>
                  <label for="free_skill_rank_<%= class_skill.id %>"><small><%= class_skill.name %></small></label>
                <% end %>
              <% end %>
            </div>
          </div>
        <% end %>

        <div class="form-actions">
          <%= hidden_field_tag 'destination', 'career' %>
          <%= f.submit "Save free skill ranks", :class => 'button' %>
          <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
                  characters_path, :class => 'button secondary' %>
        </div>
      <% end %>
    <% else %>
      <div class="row">
        <div class="small-12 columns">
          <table class="small-12 columns">
          <caption>
              <strong>You have selected the following skills to gain a free rank in at character creation:</strong><br />
              <small>To alter this you must first untrain all purchased skills on the skills page.</small>
            </caption>
            <tr>
              <% @character.career.skills.each do |class_skill| %>
                <% if @career_free_rank.include? class_skill.id %>
                  <th><%= class_skill.name %></th>
                <% end %>
              <% end %>
            </tr>
          </table>
        </div>
      </div>
    <% end %>
    <div class="panel" id="career-info">
      <% if @character.career_id %>
        <%= render :partial => 'career_info', :locals => { :career => @character.career, :changed => false } %>
      <% end %>
    </div>
  </div>
</div>